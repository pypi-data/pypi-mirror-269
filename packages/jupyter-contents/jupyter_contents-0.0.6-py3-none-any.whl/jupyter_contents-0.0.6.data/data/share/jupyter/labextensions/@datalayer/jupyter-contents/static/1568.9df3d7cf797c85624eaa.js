"use strict";(self.webpackChunk_datalayer_jupyter_contents=self.webpackChunk_datalayer_jupyter_contents||[]).push([[1568],{32084:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(84983),r=n.n(a),s=n(79872),i=n.n(s)()(r());i.push([e.id,"body {\n  overflow-y: visible;\n}\n\n.dla-Container {\n  overflow-y: auto !important;\n}\n",""]);const o=i},88411:(e,t,n)=>{n.d(t,{Z:()=>c});var a=n(84983),r=n.n(a),s=n(79872),i=n.n(s),o=n(32084),l=i()(r());l.i(o.Z),l.push([e.id,"\n",""]);const c=l},51568:(e,t,n)=>{n.r(t),n.d(t,{ContentTab:()=>r.X,IJupyterContent:()=>a.IJupyterContent});var a=n(48416),r=n(64695)},69252:(e,t,n)=>{n.d(t,{q:()=>s});var a=n(1865),r=n(66274);async function s(e="",t={}){const n=r.ServerConnection.makeSettings(),s=a.URLExt.join(n.baseUrl,"jupyter_contents",e);let i;try{i=await r.ServerConnection.makeRequest(s,t,n)}catch(e){throw new r.ServerConnection.NetworkError(e)}let o=await i.text();if(o.length>0)try{o=JSON.parse(o)}catch(e){console.log("Not a JSON response body.",i)}if(!i.ok)throw new r.ServerConnection.ResponseError(i,o.message||o);return o}},48416:(e,t,n)=>{n.r(t),n.d(t,{IJupyterContent:()=>de,default:()=>pe});var a=n(97930),r=n(56653),s=n(96129),i=n(67370),o=n(8826),l=n(58592);const c=new(n(1339).zZ)({name:"@datalayer/icons:briefcase",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72" fill="currentColor" aria-hidden="true">\n  <path fill="#FCEA2B" d="M41.596 36.354l-8.54-.037h-1.993v2.958l.009 3.093 7.705.034h2.82z"/>\n  <path fill="#6A462F" d="M31.531 42.145l-.364-3.178-13.2-.454c-1.91 0-6.463-.195-6.86-1.987l.43 5.876h.02c.119-.42.488.575.947.575.458 0 .828-.995.946-.575H30.22c-.023-.084 1.312-.166 1.312-.257zM56.874 38.664H41.95v3.481c0 .091.512.173.49.257h16.05c.124-.41.49.784.942.784s.818-1.194.942-.784h.012l.44-6.27c-.235 1.983-3.213 1.963-3.953 2.532zM60.874 35.279v.178l.012-.178z"/>\n  <path fill="#A57939" d="M12.008 36.813s-.221 1.91 3.76 1.851c2.983-.043 14.852 0 14.852 0l1.024-1.898 9.399-.08 1.397 1.697s11.97.51 14.434.281c3.239-.302 3-3.89 3-4V19.921H12.008v16.892zM42.492 41.653H12.533v.02c.539.017-.525 1.317-.525 1.859l.496 15.318h46.929V42.688c0-.494-.637-.885-.168-.967l.002-.068H42.492z"/>\n  <g fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2">\n    <path d="M31.456 15.89v-3.838H41.78v3.839M59.433 42.688V58.85h-46.93V42.668M41.951 38.664h14.923a3 3 0 003-3V19.921H12.008v15.743a3 3 0 003 3H30.62"/>\n    <path d="M31.167 36.317h10.325v5.828H31.167z"/>\n  </g>\n</svg>\n'});var d=n(69252),h=n(74512),u=n(33078),p=n(66029),m=n(59689),y=n(59606),f=n(32126),w=n(61726),g=n(2947),x=n(4231);class j{_secondsPassed=0;constructor(){}reset(){this._secondsPassed=0}increaseTimer(){this._secondsPassed+=1}get secondsPassed(){return this._secondsPassed}}const b=(0,x.create)(((e,t)=>({tab:0,getIntTab:()=>Math.floor(t().tab),setTab:t=>e((e=>({tab:t}))),timer:new j,increaseTimer:()=>{t().timer.increaseTimer(),e((e=>({secondsPassed:t().timer.secondsPassed})))},secondsPassed:0})));var v=n(64695),C=n(21809),F=n(11048),P=n(62005),k=n(5917);const _={small:16,medium:32,large:64},S=p.forwardRef((function({title:e,titleId:t,size:n,colored:a,...r},s){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 243.75 243.75",fill:a?"currentColor":["#fff","#fffff","white","#FFF","#FFFFFF"].includes("currentColor")?"white":"currentColor","aria-hidden":"true",width:n?"string"==typeof n?_[n]:n:"16px",ref:s,"aria-labelledby":t},r),e?p.createElement("title",{id:t},e):null,p.createElement("g",{fill:a?"#fff":["#fff","#fffff","white","#FFF","#FFFFFF"].includes("#fff")?"white":"currentColor",strokeWidth:2.928,transform:"translate(0 -308.268)"},p.createElement("circle",{cx:121.875,cy:430.143,r:120.411,stroke:"#000"}),p.createElement("path",{fillRule:"evenodd",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",d:"M119.675 477.588l.253-140.166c-73.532 5.11-86.696 84.242-28.25 114.7l.61 25.34z"}),p.createElement("path",{fillRule:"evenodd",stroke:"#000",d:"M120.07 482.652H93.813c-2.945 4.667-3.575 8.04 2.748 13.127-6.62.865-6.378 8.548-2.9 10.686-4.242 1.556-5.282 8.727 6.869 7.937l1.625 5.486c.733 2.113 1.746 2.545 2.76 2.973l10.458-.086c1.992-.72 4.299-2.105 4.39-5.015z"}),p.createElement("path",{fillRule:"evenodd",stroke:"#f75c59",strokeLinecap:"round",strokeLinejoin:"round",d:"M124.291 477.462l-.469-139.95c73.532 5.11 86.696 84.458 28.25 114.916l-.61 25.34z"}),p.createElement("path",{fillRule:"evenodd",stroke:"#f75c59",d:"M125.32 482.957l-.306 32.361c1.317 11.059 11.072 8.629 10.99-.61v-31.751zM139.957 482.957l-.305 32.361c1.317 11.059 11.072 8.629 10.99-.61v-31.751z"}),p.createElement("path",{fillRule:"evenodd",stroke:"#f8d05b",d:"M112.412 477.238l-16.948-73.934c-4.23-19.168-16.974-14.783-11.444-.557 6.267 10.896 28.39 21.763 33.582 6.106-4.523-5.743-6.628-12.59 1.333-16.65"}),p.createElement("path",{fillRule:"evenodd",stroke:"#f75c59",strokeLinejoin:"round",d:"M131.627 399.814c1.778-4.471 12.628-9.482 19.487-14.062 7.117 3.213 17.741 13.145 12.804 25.555-1.265 4.901-28.05 4.544-30.224 2.137-4.481-4.606-3.115-10.024-2.067-13.63zM128.198 428.251c-.91 7.576-.577 13.909-.763 20.76 3.425.788 7.262.337 11.082-.062-2.75-6.95-5.704-13.748-10.319-20.698z"})))})),E=e=>{const{version:t}=e,[n,a]=(0,p.useState)(!1);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(C.Z,{as:"h2",children:["🪐 💼 Jupyter Contents",(0,h.jsx)(F.Z,{sx:{marginLeft:1},children:t})]}),(0,h.jsx)(f.Z,{children:(0,h.jsx)(P.Z,{children:"Manage Contents from Jupyter."})}),(0,h.jsx)(f.Z,{mt:3,children:n?(0,h.jsx)(S,{size:300,onClick:e=>a(!1)}):(0,h.jsx)("img",{src:"https://assets.datalayer.tech/releases/datalayer-0.3.0-black-snake_1024.png",onClick:e=>a(!0),style:{width:"100%"}})}),(0,h.jsx)(f.Z,{children:(0,h.jsx)(k.Z,{href:"https://datalayer.tech/docs/releases/0.3.0-black-snake",target:"_blank",children:(0,h.jsx)(P.Z,{as:"h4",children:"Datalayer 0.3.0 Black Snake Release"})})}),(0,h.jsx)(f.Z,{children:(0,h.jsx)(k.Z,{href:"https://github.com/datalayer/jupyter-contents",target:"_blank",children:(0,h.jsx)(P.Z,{as:"h4",children:"Source code"})})})]})},I=e=>{const{setTab:t,getIntTab:n}=b(),a=n(),[r,s]=(0,p.useState)("");return(0,p.useEffect)((()=>{(0,d.q)("config").then((e=>{s(e.version)})).catch((e=>{console.error(`Error while accessing the jupyter server jupyter_contents extension.\n${e}`)}))}),[]),(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(m.f6,{children:(0,h.jsx)(y.Z,{children:(0,h.jsxs)(f.Z,{children:[(0,h.jsx)(f.Z,{children:(0,h.jsxs)(w.J,{"aria-label":"content",children:[(0,h.jsx)(w.J.Item,{"aria-label":"content-content","aria-current":0===a?"page":void 0,onSelect:e=>{e.preventDefault(),t(0)},children:"Content"}),(0,h.jsx)(w.J.Item,{"aria-label":"content-about","aria-current":1===a?"page":void 0,icon:()=>(0,h.jsx)(g.BriefcaseIcon,{colored:!0}),onSelect:e=>{e.preventDefault(),t(1)},children:"About"})]})}),(0,h.jsxs)(f.Z,{m:3,children:[0===a&&(0,h.jsx)(v.Z,{}),1===a&&(0,h.jsx)(E,{version:r})]})]})})})})};class H extends s.ReactWidget{_app;_jupyterIAM;_jupyterContent;constructor(e,t,n){super(),this._app=e,this._jupyterIAM=t,this._jupyterContent=n,this.addClass("dla-Container")}render(){return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(I,{iam:this._jupyterIAM,content:this._jupyterContent,adapter:u.JupyterLabAppAdapter.create(this._app)})})}}const M=()=>{const{timer:e,increaseTimer:t,secondsPassed:n}=b();return(0,p.useEffect)((()=>{setInterval((()=>{t()}),1e3)}),[]),(0,h.jsxs)("button",{onClick:()=>e.reset(),children:["Jupyter Contents: ",n]})};var Z=n(7700),T=n(4208);const D=new class{secondsPassed=0;constructor(){(0,Z.makeAutoObservable)(this)}reset(){this.secondsPassed=0}increaseTimer(){this.secondsPassed+=1}};setInterval((()=>{D.increaseTimer()}),1e3);const z=(0,T.observer)((({mobxTimer:e})=>(0,h.jsxs)("button",{onClick:()=>e.reset(),children:["Jupyter Contents Mobx: ",e.secondsPassed]})));var A=n(56199),J=n(62086),R=n(40158),$=n(66274),L=n(1865),B=n(74901);const V="FileSystem",O=`${V}:`;async function U(e){const t=[];for await(const n of e)t.push(n);return t}class q{get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,B.Signal.clearData(this))}get name(){return V}get serverSettings(){return $.ServerConnection.makeSettings()}get fileChanged(){return this._fileChanged}get rootHandle(){return this._rootHandle}set rootHandle(e){this._rootHandle=e}async get(e,t){if(e=this.cleanPath(e),!this._rootHandle)return{name:"",path:"",created:(new Date).toISOString(),last_modified:(new Date).toISOString(),format:null,mimetype:"",content:null,writable:!0,type:"directory"};const n=await this.getParentHandle(e),a=L.PathExt.dirname(e),r=L.PathExt.basename(e);let s;if(s=r?await this.getHandle(n,r):n,"file"===s.kind)return this.getFileModel(s,a,!0);{const e=[];for await(const t of s.values())"file"===t.kind?e.push(await this.getFileModel(t,L.PathExt.join(a,r))):e.push({name:t.name,path:L.PathExt.join(a,r,t.name),created:"",last_modified:"",format:null,mimetype:"",content:null,writable:!0,type:"directory"});return{name:r,path:L.PathExt.join(a,r),last_modified:"",created:"",format:null,mimetype:"",content:e,size:void 0,writable:!0,type:"directory"}}}async getDownloadUrl(e){throw new Error("Method not implemented.")}async newUntitled(e){let t="";e&&e.path&&(t=this.cleanPath(e.path));const n=e?.type||"directory",a=L.PathExt.join(t,"directory"===n?"Untitled Folder":"untitled"),r=e?.ext||"txt",s=await this.getParentHandle(a);let i=L.PathExt.basename(a);const o=i;let l;if("directory"===n){let e=1;for(;await this.hasHandle(s,i);)i=`${o} ${e++}`;await s.getDirectoryHandle(i,{create:!0}),l=await this.get(L.PathExt.join(t,i))}else{let e=1;for(;await this.hasHandle(s,`${i}.${r}`);)i=`${o}${e++}`;const n=`${i}.${r}`;await s.getFileHandle(n,{create:!0}),l=await this.get(L.PathExt.join(t,n))}return this._fileChanged.emit({type:"new",oldValue:null,newValue:l}),l}async delete(e){e=this.cleanPath(e);const t=await this.getParentHandle(e);await t.removeEntry(L.PathExt.basename(e),{recursive:!0}),this._fileChanged.emit({type:"delete",oldValue:{path:e},newValue:null})}async rename(e,t){e=this.cleanPath(e),t=this.cleanPath(t),await this.doCopy(e,t),await this.delete(e);const n=this.get(t);return n.then((t=>{this._fileChanged.emit({type:"rename",oldValue:{path:e},newValue:t})})),n}async save(e,t){e=this.cleanPath(e);const n=await this.getParentHandle(e);if("directory"===t?.type)return await n.getDirectoryHandle(L.PathExt.basename(e),{create:!0}),this.get(e);const a=await n.getFileHandle(L.PathExt.basename(e),{create:!0}),r=await a.createWritable({}),s=t?.format,i=t?.content;if("json"===s){const e=JSON.stringify(i,null,2);await r.write(e)}else if("base64"===s){const e=await function(e,t="text/plain;charset=UTF-8"){return fetch(`data:${t};base64,`+e).then((e=>e.blob()))}(i);await r.write(e)}else await r.write(i);return await r.close(),this.get(e)}async copy(e,t){e=this.cleanPath(e);const n=await this.get(e),a=L.PathExt.dirname(e);let r=n.name;if(a===t){const e=L.PathExt.extname(n.name);r=e?`${r.slice(0,r.length-e.length)} (Copy)${e}`:`${r} (Copy)`}const s=L.PathExt.join(t,r);return await this.doCopy(e,s),this.get(s)}async createCheckpoint(e){return{id:"test",last_modified:(new Date).toISOString()}}async listCheckpoints(e){return[{id:"test",last_modified:(new Date).toISOString()}]}restoreCheckpoint(e,t){return Promise.resolve(void 0)}deleteCheckpoint(e,t){return Promise.resolve(void 0)}async getParentHandle(e){const t=this._rootHandle;if(!t)throw new Error("No root file handle");let n=t;for(const t of e.split("/").slice(0,-1))n=await n.getDirectoryHandle(t);return n}async getHandle(e,t){const n=(await U(e.values())).filter((e=>e.name===t));if(n.length)return n[0];throw new Error(`${t} does not exist.`)}async hasHandle(e,t){const n=(await U(e.values())).filter((e=>e.name===t));return Boolean(n.length)}async getFileModel(e,t,n){const a=await e.getFile();let r,s=null;return r=a.type&&a.type.split("/")&&["image","audio","video"].includes(a.type.split("/")[0])?"base64":"text",n&&(s="base64"===r?function(e){let t="";const n=new Uint8Array(e);for(let e=0;e<n.byteLength;e++)t+=String.fromCharCode(n[e]);return window.btoa(t)}(await a.arrayBuffer()):await a.text()),{name:a.name,path:L.PathExt.join(t,a.name),created:new Date(a.lastModified).toISOString(),last_modified:new Date(a.lastModified).toISOString(),format:r,content:s,writable:!0,type:"file",mimetype:a.type}}async doCopy(e,t){const n=await this.getParentHandle(e),a=L.PathExt.basename(e);let r;r=a?await this.getHandle(n,a):n;const s=await this.getParentHandle(t),i=L.PathExt.basename(t);if("directory"===r.kind){await s.getDirectoryHandle(i,{create:!0});for await(const n of r.values())await this.doCopy(L.PathExt.join(e,n.name),L.PathExt.join(t,n.name))}else{const e=await s.getFileHandle(i,{create:!0}),t=await e.createWritable({}),n=await r.getFile(),a=await n.arrayBuffer();t.write(a),await t.close()}}cleanPath(e){return e.includes(O)?e.replace(O,""):e}_isDisposed=!1;_fileChanged=new B.Signal(this);_rootHandle=null}const N="FileSystemAccess",W={id:"@datalayer/jupyter-contents:local-drive",requires:[A.IFileBrowserFactory,J.ITranslator],optional:[i.ISettingRegistry,s.IToolbarWidgetRegistry],autoStart:!0,activate:(e,t,n,a,r)=>{const i=window.showDirectoryPicker;if(!i)return void console.warn("The File System Access APII is not supported in this browser.");const{serviceManager:o}=e,{createFileBrowser:l}=t,c=n.load("jupyterlab-filesystem-access"),d=new q;o.contents.addDrive(d);const h=l("jp-filesystem-browser",{driveName:d.name,restore:!1});h.title.caption=c.__("Local File System"),h.title.icon=R.listIcon,h.showFileCheckboxes=!1;const u=h.toolbar;u.id="jp-filesystem-toolbar",r&&a&&((0,s.setToolbar)(u,(0,s.createToolbarFactory)(r,a,N,W.id,n??J.nullTranslator),u),r.addFactory(N,"open-folder",(e=>new s.ToolbarButton({icon:R.folderIcon,onClick:async()=>{const e=await i();e&&(d.rootHandle=e,h.model.cd("/"))},tooltip:c.__("Open a new folder")}))),r.addFactory(N,"uploader",(e=>new A.Uploader({model:h.model,translator:n}))),r.addFactory(N,"filename-searcher",(e=>{const t=(0,R.FilenameSearcher)({updateFilter:(e,t)=>{h.model.setFilter((t=>e(t.name.toLowerCase())))},useFuzzyFilter:!0,placeholder:c.__("Filter files by name"),forceRefresh:!1});return t.addClass("jp-FileBrowser-filterBox"),t}))),e.shell.add(h,"left",{type:"FileSystemAccess"})}},X=W;var G=n(13989),K=n.n(G),Q=n(90299),Y=n.n(Q),ee=n(32433),te=n.n(ee),ne=n(1889),ae=n.n(ne),re=n(10342),se=n.n(re),ie=n(99638),oe=n.n(ie),le=n(88411),ce={};ce.styleTagTransform=oe(),ce.setAttributes=ae(),ce.insert=te().bind(null,"head"),ce.domAPI=Y(),ce.insertStyleElement=se(),K()(le.Z,ce),le.Z&&le.Z.locals&&le.Z.locals;const de=new a.Token("@datalayer/jupyter-contents:plugin");var he;!function(e){e.create="create-jupyter-contents-widget"}(he||(he={}));const ue={id:"@datalayer/jupyter-contents:plugin",autoStart:!0,requires:[s.ICommandPalette,l.IJupyterIAM],optional:[i.ISettingRegistry,o.ILauncher,r.ILayoutRestorer],provides:de,activate:(e,t,n,a,r,i)=>{const{commands:o}=e,l=he.create,h=new s.WidgetTracker({namespace:"jupyter-contents"});i&&i.restore(h,{command:l,name:()=>"jupyter-contents"});const u={timer:new j,TimerView:M,mobxTimer:D,MobxTimerView:z};o.addCommand(l,{caption:"Show Jupyter Contents",label:"Jupyter Contents",icon:c,execute:()=>{const t=new H(e,n,u),a=new s.MainAreaWidget({content:t});a.title.label="Jupyter Contents",a.title.icon=c,e.shell.add(a,"main"),h.add(a)}});const p="Datalayer";t.addItem({command:l,category:p});const m=e=>{const t=e.get("showInLauncher").composite;r&&t&&r.add({command:l,category:p,rank:5.1})};return a&&a.load(ue.id).then((e=>{console.log("@datalayer/jupyter-contents settings loaded:",e.composite),m(e),e.changed.connect(m)})).catch((e=>{console.error("Failed to load settings for @datalayer/jupyter-contents.",e)})),(0,d.q)("config").then((e=>{console.log(e)})).catch((e=>{console.error(`Error while accessing the jupyter server jupyter_contents extension.\n${e}`)})),console.log("JupyterLab plugin @datalayer/jupyter-contents:plugin is activated."),u}},pe=[ue,X]},64695:(e,t,n)=>{n.d(t,{X:()=>d,Z:()=>h});var a=n(74512),r=n(66029),s=n(32126),i=n(62005),o=n(22705),l=n(16419),c=n(69252);const d=()=>{const[e,t]=(0,r.useState)(new Array);return(0,r.useEffect)((()=>{(0,c.q)("containers").then((e=>{const n=e.containers.map(((e,t)=>({id:t,...e})));t(n)})).catch((e=>{console.error(`Error while accessing the jupyter server jupyter_contents extension.\n${e}`)}))}),[]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(s.Z,{children:(0,a.jsxs)(o.i.Container,{children:[(0,a.jsx)(o.i.Title,{as:"h2",id:"containers",children:"Content containers"}),(0,a.jsx)(o.i.Subtitle,{as:"p",id:"containers-subtitle",children:"List of Content containers."}),(0,a.jsx)(l.w,{"aria-labelledby":"containers","aria-describedby":"containers-subtitle",data:e,columns:[{header:"Image",field:"Config.Image",renderCell:e=>(0,a.jsx)(i.Z,{children:e.Config.Image})},{header:"Id",field:"Id",renderCell:e=>(0,a.jsx)(i.Z,{children:e.Id})},{header:"Created",field:"Created",renderCell:e=>(0,a.jsx)(i.Z,{children:e.Created})}]})]})})})},h=d}}]);