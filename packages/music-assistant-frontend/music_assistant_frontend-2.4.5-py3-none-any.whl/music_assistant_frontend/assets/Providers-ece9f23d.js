import{v as R,aa as F,r as O,c as j,L as t,an as G,b as Q,w as q,ae as H,y as s,E as f,G as V,x as a,F as w,l as d,A as i,Q as _,N as m,$ as l,z as c,n as J,I as v,aS as b,B as h,af as K,a8 as T,a9 as W}from"./index-b12bd80e.js";import{L as S,_ as B,B as g,C as X,a as Y}from"./Container-559ac507.js";import{A as Z}from"./Alert-49bdea68.js";import{e as ee}from"./VMenu-29f14170.js";import{l as ne,n as y}from"./forwardRefs-ccde8f15.js";import{V as te}from"./VCard-ff384e61.js";import{V as ae}from"./VToolbar-4a427573.js";/* empty css              */import"./VAlert-b44bc40e.js";import"./VCardText-a5346cc1.js";const ie=p=>(T("data-v-15cfe784"),p=p(),W(),p),se=ie(()=>h("br",null,null,-1)),oe={class:"line-clamp-1"},de={class:"line-clamp-1"},re=R({__name:"Providers",setup(p){const k=F(),u=O([]),I=j(()=>Object.values(t.providerManifests).filter(n=>!n.hidden&&(n.multi_instance||!u.value.find(o=>o.domain==n.domain))).sort((n,o)=>(n.name||t.providerManifests[n.domain].name).toUpperCase()>(o.name||t.providerManifests[o.domain].name).toUpperCase()?1:-1)),$=t.subscribe(G.PROVIDERS_UPDATED,()=>{A()});Q($);const A=async function(){u.value=await t.getProviderConfigs()},N=function(n){t.removeProviderConfig(n),u.value=u.value.filter(o=>o.instance_id!=n)},C=function(n){k.push(`/settings/editprovider/${n}`)},x=function(n){if(n.depends_on&&!t.getProvider(n.depends_on)){const o=t.getProviderName(n.depends_on);confirm(l("settings.provider_depends_on_confirm",[n.name,o]))&&k.push(`/settings/addprovider/${n.depends_on}`);return}k.push(`/settings/addprovider/${n.domain}`)},D=function(n){n.enabled=!n.enabled,t.saveProviderConfig(n.domain,{enabled:n.enabled},n.instance_id)},U=function(n){t.getData("config/providers/reload",{instance_id:n}).catch(o=>alert(o))},E=function(n){window.open(n,"_blank")};return q(()=>t.providers,n=>{n&&A()},{immediate:!0}),(n,o)=>{const L=H("hold");return s(!0),f(w,null,V(a(b),r=>(s(),f("div",{key:r,style:{"margin-bottom":"10px"}},[d(ae,{color:"transparent",density:"compact",class:"titlebar"},{title:i(()=>[_(m(a(l)(`settings.${r}providers`)),1)]),append:i(()=>[I.value.filter(e=>e.type==r).length?(s(),c(ee,{key:0},{activator:i(({props:e})=>[d(ne,J({ref_for:!0},e,{color:"accent",variant:"outlined"}),{default:i(()=>[_(m(a(l)("settings.add_new_provider_button",[r])),1)]),_:2},1040)]),default:i(()=>[d(te,{density:"compact"},{default:i(()=>[(s(!0),f(w,null,V(I.value.filter(e=>e.type==r),e=>(s(),c(S,{key:e.domain,density:"compact",style:{"padding-top":"0","padding-bottom":"0","margin-bottom":"0"},title:e.name,onClick:P=>x(e)},{prepend:i(()=>[d(B,{domain:e.domain,size:26,class:"media-thumb",style:{"margin-left":"10px"}},null,8,["domain"])]),_:2},1032,["title","onClick"]))),128))]),_:2},1024)]),_:2},1024)):v("",!0)]),_:2},1024),r==a(b).MUSIC&&u.value.filter(e=>e.type==a(b).MUSIC&&e.domain in a(t).providerManifests&&!a(t).providerManifests[e.domain].hidden).length==0?(s(),c(Z,{key:0,icon:"mdi-radio-tower"},{default:i(()=>[h("b",null,m(a(l)("settings.no_providers")),1),se,_(" "+m(a(l)("settings.no_providers_detail")),1)]),_:1})):v("",!0),d(X,null,{default:i(()=>[(s(!0),f(w,null,V(u.value.filter(e=>e.type==r),e=>{var P;return K((s(),c(S,{key:e.instance_id,link:"","context-menu-items":[{label:"settings.configure",labelArgs:[],action:()=>{C(e.instance_id)},icon:"mdi-cog"},{label:e.enabled?"settings.disable":"settings.enable",labelArgs:[],action:()=>{D(e)},icon:"mdi-cancel",disabled:a(t).providerManifests[e.domain].builtin},{label:"settings.documentation",labelArgs:[],action:()=>{E(a(t).providerManifests[e.domain].documentation)},icon:"mdi-bookshelf",disabled:!a(t).providerManifests[e.domain].documentation},{label:"settings.sync",labelArgs:[],action:()=>{a(t).startSync(void 0,[e.instance_id])},icon:"mdi-sync",hide:((P=a(t).providers[e.instance_id])==null?void 0:P.available)&&r!=a(b).MUSIC},{label:"settings.delete",labelArgs:[],action:()=>{N(e.instance_id)},icon:"mdi-delete",hide:a(t).providerManifests[e.domain].builtin||a(t).providerManifests[e.domain].load_by_default&&e.domain==e.instance_id},{label:"settings.reload",labelArgs:[],action:()=>{U(e.instance_id)},icon:"mdi-refresh"}],onClick:M=>C(e.instance_id)},{prepend:i(()=>[d(B,{domain:e.domain,size:40,class:"listitem-media-thumb"},null,8,["domain"])]),title:i(()=>[h("div",oe,m(e.name||a(t).providerManifests[e.domain].name),1)]),subtitle:i(()=>[h("div",de,m(a(t).providerManifests[e.domain].description),1)]),append:i(()=>{var M;return[a(t).syncTasks.value.filter(z=>z.provider_instance==e.instance_id).length>0?(s(),c(g,{key:0,icon:"",title:a(l)("settings.sync_running")},{default:i(()=>[d(y,{color:"grey"},{default:i(()=>[_(" mdi-sync ")]),_:1})]),_:1},8,["title"])):v("",!0),e.enabled?e.last_error?(s(),c(g,{key:2,icon:"",title:e.last_error},{default:i(()=>[d(y,{color:"red"},{default:i(()=>[_(" mdi-alert-circle ")]),_:1})]),_:2},1032,["title"])):(M=a(t).providers[e.instance_id])!=null&&M.available?v("",!0):(s(),c(g,{key:3,icon:"",title:a(l)("settings.not_loaded")},{default:i(()=>[d(y,{icon:"mdi-timer-sand"})]),_:1},8,["title"])):(s(),c(g,{key:1,icon:"",title:a(l)("settings.provider_disabled")},{default:i(()=>[d(y,{color:"grey"},{default:i(()=>[_(" mdi-cancel ")]),_:1})]),_:1},8,["title"]))]}),_:2},1032,["context-menu-items","onClick"])),[[L,()=>{C(e.instance_id)}]])}),128))]),_:2},1024)]))),128)}}});const ye=Y(re,[["__scopeId","data-v-15cfe784"]]);export{ye as default};
