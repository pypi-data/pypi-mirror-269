import{d as R,i as A,b as g,k as ve,c as f,o as E,e as D,f as a,t as P,m as G,_ as k,S as me,r as x,U as $,H as K,V as B,Q,W as fe,I as _e,w as X,v as Y,h as ge,F as he,s as ye,n as J,p as Z,j as ee,z as Ce,u as q,l as be,q as Ie,R as Se}from"./index-CK0qFcoM.js";const $e={class:"ChildlessPlaceholder"},Pe={class:"content"},Ee={class:"title"},Te={key:0,class:"message"},De=10,Me=R({__name:"ChildlessPlaceholder",props:{componentId:{}},setup(p){const o=A(g.core),m=p,{componentId:l}=ve(m),s=f(()=>o.getComponentById(l.value)),T=f(()=>o.getComponentDefinition(s.value.type)),r=(h,y)=>{const c=h.map(I=>o.getComponentDefinition(I)).map(I=>I==null?void 0:I.name);return`${c.slice(0,-1).join(", ")} ${c.length>1?y:""} ${c.at(-1)}`},S=f(()=>{const h=o.getContainableTypes(l.value);let y;return h.length<=De&&(y=`You can add ${r(h,"and")} components`),y});return(h,y)=>(E(),D("div",$e,[a("div",Pe,[a("div",Ee,[a("h2",null,"Empty "+P(T.value.name),1)]),S.value?(E(),D("div",Te,P(S.value),1)):G("",!0)])]))}}),Be=k(Me,[["__scopeId","data-v-7f547886"]]),xe={class:"RenderError"},we={class:"title"},Ve={class:"message"},Ae=R({__name:"RenderError",props:{componentType:{},message:{}},setup(p){const o=p;return(m,l)=>(E(),D("div",xe,[a("div",we,[a("h2",null,"Error rendering "+P(o.componentType),1)]),a("div",Ve,P(o.message),1)]))}}),Fe={props:["componentId","instancePath","instanceData"],setup(p){const o=A(g.core),m=A(g.builderManager),l=p.componentId,s=f(()=>o.getComponentById(l)),T=me(s.value.type),r=p.instancePath,S=p.instanceData,{getEvaluatedFields:h,isComponentVisible:y}=Q(o),t=h(r),c=f(()=>o.getComponents(l,{sortedByPosition:!0})),d=f(()=>!!m&&m.getMode()!="preview"),I=f(()=>d.value&&!s.value.isCodeManaged&&s.value.type!=="root"),w=(e,n)=>(e?o.getContainableTypes(e):["root"]).includes(n),M=x(!1),se=f(()=>o.getUserFunctions()),ne=()=>{if(!(c.value.length>0))return B(Be,{componentId:s.value.id})},j=(e,n=0,u={})=>B(te,{componentId:e,key:`${e}:${n}`,instancePath:[...r,{componentId:e,instanceNumber:n}],instanceData:[...S,x(null)],...u}),oe=e=>n=>{if(!w(l,n.type)&&e==="default")return!0;const i=o.getComponentDefinition(n.type).slot??"default";return i==="*"||i===e},W=(e=0,n="default",u=()=>!0,i=!1)=>{const v=_=>!d.value||i?[]:[B("div",{"data-streamsync-slot-of-id":l,"data-streamsync-position":_})],C=c.value.filter(oe(n)).filter(u),b=C.filter(_=>!_.isCodeManaged).map(_=>j(_.id,e,{contextSlot:n})),V=C.filter(_=>_.isCodeManaged).map(_=>j(_.id,e,{contextSlot:n}));return[...v(0),...b.map((_,F)=>[_,v(F+1)]).flat(),...V]},z=(e=>e.map(n=>`${n.componentId}:${n.instanceNumber}`).join(","))(r);$(g.evaluatedFields,t),$(g.componentId,l),$(g.isBeingEdited,d),$(g.isDisabled,M),$(g.instancePath,r),$(g.instanceData,S),$(g.renderProxiedComponent,j),$(g.getChildrenVNodes,W),$(g.flattenedInstancePath,z);const ae={"data-streamsync-id":l,"data-streamsync-instance-path":z},N=x(!1);K(()=>(m==null?void 0:m.getSelectedId())==l,e=>{N.value=e}),K(()=>t,()=>{N.value=!1},{deep:!0});const H=f(()=>c.value.length==0),le=f(()=>y(l,r)),ce=(e,n)=>{if(!e.startsWith("$")&&!n)return i=>{let v=!1;se.value.some(C=>C.name==e&&C.args.includes("payload"))&&(v=!0),o.forwardEvent(i,r,v)};if(e.startsWith("$goToPage_")){const i=e.substring(10);return v=>o.setActivePageFromKey(i)}return null},re=f(()=>{const e={},n=Object.keys(s.value.handlers??{}),u=s.value.binding?[s.value.binding.eventType]:[];return Array.from(new Set([...n,...u])).forEach(v=>{var V;const C=`on${v.charAt(0).toUpperCase()}${v.slice(1)}`,b=v===((V=s.value.binding)==null?void 0:V.eventType);e[C]=_=>{var O,U;b&&o.forwardEvent(_,r,!0);const F=(O=s.value.handlers)==null?void 0:O[v];F&&((U=ce(F,b))==null||U(_))}}),e}),ie=f(()=>{var u;const e=(u=o.getComponentDefinition(s.value.type))==null?void 0:u.fields;if(!e)return;const n={};return Object.keys(e).forEach(i=>{e[i].applyStyleVariable&&t[i]&&(n[`--${i}`]=t[i].value)}),n}),de=f(()=>{var C;const e="cssClasses",n=(C=o.getComponentDefinition(s.value.type))==null?void 0:C.fields;if(!n||!n[e]||!t[e])return;const u=t[e].value,i=u==null?void 0:u.split(" ").map(b=>b.trim()),v={};return i.forEach(b=>{v[b]=!0}),v}),ue=function(){return{class:{[`ss-type-${s.value.type}`]:!0,component:!0,childless:H.value,selected:N.value,disabled:M.value,beingEdited:d.value,...de.value},style:{...ie.value,...le.value?{}:{display:"none"}},...ae,...M.value?[]:re.value,draggable:I.value}},pe=(e,n)=>d.value?B(Ae,{...e,componentType:s.value.type,message:n}):B("div");return()=>{const e=d.value?ne():void 0,n=({instanceNumber:i=0,slotName:v="default",componentFilter:C=()=>!0,positionlessSlot:b=!1})=>H.value?b?void 0:e:W(i,v,C,b),u={...ue()};return w(s.value.parentId,s.value.type)?B(T,u,{default:n}):pe(u,"Parent is not suitable for this component")}}},te=k(Fe,[["__scopeId","data-v-d7a0a5d8"]]),L=p=>(Z("data-v-54d2c60b"),p=p(),ee(),p),Re=L(()=>a("i",{class:"ri-notification-2-line ri-xl"},null,-1)),ke={class:"counter"},Le=L(()=>a("div",{class:"balloonFlash"},null,-1)),je={class:"main"},Ne=L(()=>a("i",{class:"ri-close-line"},null,-1)),Ke=L(()=>a("i",{class:"ri-error-warning-fill ri-xl"},null,-1)),We=[Ke],ze={class:"content"},He={class:"title"},Oe={class:"time"},Ue={class:"message"},Xe=100,Ye=R({__name:"RendererNotifications",setup(p){const o=A(g.core),m=x(!1),l=x(null),s=fe([]),T=h=>{const{type:y,title:t,message:c,code:d}=h;s.unshift({type:y,title:t,message:c,code:d,timestampReceived:new Date}),s.splice(Xe),l.value.classList.remove("alert"),l.value.offsetWidth,l.value.classList.add("alert")};_e(()=>{o.addMailSubscription("notification",T)});const r=()=>{s.length!=0&&(m.value=!m.value)},S=()=>{s.splice(0),m.value=!1};return(h,y)=>X((E(),D("div",{class:"RendererNotifications",onClick:r},[a("div",{ref_key:"balloon",ref:l,class:"balloon",title:"Toggle notifications"},[Re,a("div",ke,P(s.length),1)],512),Le,X(a("div",je,[a("div",{class:"clearContainer"},[a("button",{onClick:S},[Ne,ge(" Clear all ")])]),(E(!0),D(he,null,ye(s,(t,c)=>(E(),D("div",{key:c,class:"notification"},[a("div",{class:J(["icon",t.type])},We,2),a("div",ze,[a("header",null,[a("strong",He,P(t.title),1),a("span",Oe,P(t.timestampReceived.toLocaleTimeString()),1)]),a("div",Ue,P(t.message),1)])]))),128))],512),[[Y,m.value]])],512)),[[Y,s.length>0]])}}),qe=k(Ye,[["__scopeId","data-v-54d2c60b"]]),Ge=p=>(Z("data-v-7f4207e0"),p=p(),ee(),p),Qe=Ge(()=>a("div",{class:"loadingBar"},null,-1)),Je={class:"rootComponentArea"},Ze=R({__name:"ComponentRenderer",setup(p){const o=A(g.core),m=Q(o),l=o.getComponentById("root");l||console.error("No root component found.");const s=[{componentId:"root",instanceNumber:0}],T=[x(null)],r=m.getEvaluatedFields(s),S=f(()=>{var t,c,d,I,w,M;return{"--accentColor":(t=r.accentColor)==null?void 0:t.value,"--emptinessColor":(c=r.emptinessColor)==null?void 0:c.value,"--containerBackgroundColor":(d=r.parentIdBackgroundColor)==null?void 0:d.value,"--primaryTextColor":(I=r.primaryTextColor)==null?void 0:I.value,"--secondaryTextColor":(w=r.secondaryTextColor)==null?void 0:w.value,"--separatorColor":(M=r.separatorColor)==null?void 0:M.value}}),h=f(()=>o.getFrontendMessageMap().size>0);K(()=>{var t;return(t=r.appName)==null?void 0:t.value},t=>{y(t)},{immediate:!0});function y(t){const c=o.getMode();let d;t&&c=="edit"?d=`${t} | Streamsync Builder`:!t&&c=="edit"?d="Streamsync Builder":t&&c=="run"?d=`${t}`:!t&&c=="run"&&(d="Streamsync App"),document.title=d}return(t,c)=>(E(),D("main",{class:J(["ComponentRenderer",{loadingActive:h.value}]),tabindex:"-1",style:Se(S.value)},[Ce(qe,{class:"notifications"}),Qe,a("div",Je,[q(l)?(E(),be(te,{key:0,"component-id":q(l).id,"instance-path":s,"instance-data":T},null,8,["component-id"])):G("",!0),Ie(t.$slots,"default",{},void 0,!0)])],6))}}),st=k(Ze,[["__scopeId","data-v-7f4207e0"]]);export{st as default};
